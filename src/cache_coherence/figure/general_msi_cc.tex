\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=5cm,
                    semithick]
   \node[state] (I)              {\texttt{I}};
   \node[state] (S) [right of=I] {\texttt{S}};
   \node[state] (M) [below of=I] {\texttt{M}};

   \path[every node/.style={}]
      (I) edge [bend left] node {\textcolor{blue}{\loadinstr{}}?\textcolor{red}{\textcolor{red}{\getsquery{}}}!\textcolor{OliveGreen}{\simpledata{}}?} (S)
      (I) edge [bend right, sloped, anchor=center] node[yshift=-1em] {\textcolor{blue}{\storeinstr{}}?\textcolor{red}{\textcolor{red}{\getmquery{}}}!\textcolor{OliveGreen}{\simpledata{}}?} (M)

      (S) edge node {\textcolor{blue}{\evictinstr{}}?} (I)
      (S) edge [bend right=90, above] node {\textcolor{red}{\textcolor{red}{\getmquery{}}}?} (I)
      (S) edge [bend left, sloped, anchor=center] node[yshift=1.5em] {\textcolor{blue}{\storeinstr{}}?\textcolor{red}{\textcolor{red}{\getmquery{}}}!\textcolor{OliveGreen}{\simpledata{}}?} (M)
      (S) edge [out=430,in=400,looseness=8] node {\textcolor{blue}{\loadinstr{}}?} (S)

      (M) edge [bend left=90, above, sloped] node {\textcolor{red}{\textcolor{red}{\getmquery{}}}?\textcolor{OliveGreen}{\simpledata{}}!} (I)
      (M) edge [bend right=90, above, sloped, anchor=center] node[yshift=-1em] {\textcolor{red}{\textcolor{red}{\getsquery{}}}?\textcolor{OliveGreen}{\simpledata{}}!\textcolor{OliveGreen}{\simpledata{}}!} (S)
      (M) edge [sloped, anchor=center] node[yshift=-1em]
         {\textcolor{blue}{\evictinstr{}}?\textcolor{red}{\putmquery{}}!\textcolor{OliveGreen}{\simpledata{}}!} (I)
      (M) edge [out=230,in=200,looseness=8] node {\textcolor{blue}{\loadinstr{}}?} (M)
      (M) edge [out=280,in=250,looseness=8] node {\textcolor{blue}{\storeinstr{}}?} (M)
   ;
\end{tikzpicture}
